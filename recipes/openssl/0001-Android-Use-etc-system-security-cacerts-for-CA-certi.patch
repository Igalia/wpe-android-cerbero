From 56ac18ba7a3f0a50cb368eb1c5bfa101ab06f39d Mon Sep 17 00:00:00 2001
From: Adrian Perez de Castro <aperez@igalia.com>
Date: Tue, 27 May 2025 17:08:50 +0300
Subject: Android: Use /etc/system/security/cacerts for CA certificates

---
 include/internal/common.h | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/include/internal/common.h b/include/internal/common.h
index 0c0415b..f7fcd43 100644
--- a/include/internal/common.h
+++ b/include/internal/common.h
@@ -82,7 +82,11 @@ __owur static ossl_inline int ossl_assert_int(int expr, const char *exprstr,
 
 # ifndef OPENSSL_SYS_VMS
 #  define X509_CERT_AREA          OPENSSLDIR
+# if defined(ANDROID) || defined(__ANDROID__)
+#  define X509_CERT_DIR           "/system/etc/security/cacerts"
+# else
 #  define X509_CERT_DIR           OPENSSLDIR "/certs"
+# endif
 #  define X509_CERT_FILE          OPENSSLDIR "/cert.pem"
 #  define X509_PRIVATE_DIR        OPENSSLDIR "/private"
 #  define CTLOG_FILE              OPENSSLDIR "/ct_log_list.cnf"
-- 
2.49.0

